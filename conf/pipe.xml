<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE page [
<!ENTITY binbase "/drive2/variantdb/trunk/ext/bin">
<!ENTITY polybase "/home/matt/software/ngs/polyphen"> 
<!-- <!ENTITY binbase "/g/data/u86/variantdb/v2.3/ext/bin"> <!ENTITY polybase "/g/data/u86/software/polyphen"> -->
]>
<pipeline>
 	
	<common>
		<!-- possible source types -->
		<source_types>human_cancer,human_related,human_single,human_related_gatk,human_single_gatk,mouse_single,mouse_cancer</source_types>	
		<!-- possible sample types-->
	<sample_types>G1_internal,ENU_internal,G1_external,ENU_external,single_affected,single_unaffected,related_affected,related_unaffected,cancer_normal_cell_line,cancer_normal_patient,cancer_tumour_primary_cell_line,cancer_tumour_primary_patient,cancer_tumour_metastatic_cell_line,cancer_tumour_metastatic_patient,mouse_cancer_normal,mouse_cancer_tumour</sample_types>
	
		<!-- possible related types -->
		<related_types>proband,mother,father,parent,brother,sister,sibling,grandfather,grandmother,son,daughter,child,other,aunt,uncle,niece,nephew,cousin,other,spouse</related_types>
		
		<database>
			<!--<db_name>vardb_2_2_test</db_name><host>localhost</host><user>matt</user>-->
			<db_name>vardb_genome_2_3</db_name>
			<host>130.56.244.153</host>
			<user>igl_user</user> 
		</database>
			
		<run_subdirs>overlap,vcf,conf,log,polyphen,summary,bam,gatk,sv</run_subdirs>
		
		<sequencing_centres>BRF,AGRF,RAM,BGI,Macrogen,Garvan,Kinghorn,Unknown,Novogene</sequencing_centres>
		
		<pipeline_version>v2.3</pipeline_version>
		
		<!-- Steps with special meaning in the pipeline-->
		<pipe_steps>			
			<first_lane>bwa</first_lane>
			<first>merge_bam</first> <!-- First step of whole pipeline -->
			<last>scp_results</last> <!-- Last step of whole pipeline -->
			<parvar_first>submit_snvs</parvar_first> <!-- Step to create parallel variant calling jobs -->
			<parvar_record>single_vcf</parvar_record> <!-- Step that runs after single chr variant calling job is done -->
			<start_non_parvar>call_all_variants</start_non_parvar>
			<parvar_merge>merge_vcf</parvar_merge> <!-- Step after all parallel variant calls done -->
			<finish_align>bam_stats</finish_align> <!-- Last step of alignment phase -->
		</pipe_steps>
		
		<!-- tells which snv types to store in DB -->
		<db_types>ALL</db_types> 
		
		<sv_callers>delly,lumpy</sv_callers>
		
	</common>
	
	<human_related_gatk>
		<organism>human</organism>
		<paired_variants>0</paired_variants>
		<parallel_vcf>1</parallel_vcf>
		<min_align_percent>85</min_align_percent> <!-- Minimum percent of reads in lane to count as passed -->
		<db_types>ALL</db_types> 
				
		<annotation_version>
			<ref_genome>hs37d5</ref_genome>
			<dbsnp_version>137_147</dbsnp_version>
			<exon_version>040614</exon_version>
			<gene_version>120116</gene_version>
			<ensembl_version>88</ensembl_version>
			<cosmic_version>75</cosmic_version>
			<chr>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 X Y</chr>
			<exac_version>0.3</exac_version>
        	<clinvar_version>070515</clinvar_version>
        	<aB_FOXP3_regulatory_version>240615</aB_FOXP3_regulatory_version>
        	<mirna_version>221116</mirna_version>
        	<dgv_version>230715</dgv_version>
       	</annotation_version>
																													
		<binaries>
			<tabix>
				<binary>&binbase;/tabix</binary>
				<version>0.2.5 (r964)</version>
			</tabix>

			<bwa>
				<binary>&binbase;/bwa</binary>
				<version>0.6.1-r104</version>
				<aln>
					<args>aln </args>
				</aln>
				<sampe>
					<args>sampe </args>
				</sampe>
			</bwa>
			
			<samtools>
				<binary>&binbase;/samtools-1.3.1</binary>
				<version>1.3.1 (using htslib 1.3.1)</version>
				<mpileup>
					<args>mpileup -C50 -uDEf</args>
				</mpileup>
			</samtools>
																												
			<bcftools>
				<binary>&binbase;/bcftools</binary>
				<version>1.3.1-16-g16414e6 (using htslib 1.3.1-36-g11661a5)</version>
				<view>
					<unpaired_args>view -vcg</unpaired_args>
				</view>
			</bcftools>
			
			<variant_predictor>
				<binary>&binbase;/variant_effect_predictor.pl</binary>
				<version>88</version>
				<args_exon>--force_overwrite --cache --offline --species human --fork 2 --canonical --coding_only --poly b --sift b --plugin CADD,&binbase;/whole_genome_SNVs.tsv.gz</args_exon>
				<args_all>--force_overwrite --cache --offline --species human --fork 2 --canonical --domains --af --pubmed --check_existing --numbers --plugin CADD,&binbase;/whole_genome_SNVs.tsv.gz --biotype --regulatory</args_all>
			</variant_predictor>
																																																		
			<javabin>
				  # on raijin- must first do ...  module load java/jdk1.7.0_25
				  <binary>java </binary>
				  <version>jdk1.8.0_60</version>
			</javabin>

			<gatk>
			  <jar>&binbase;/GATK-3.6.0/GenomeAnalysisTK.jar</jar>
			  <version>3.6.0</version>
			  <args_realign_target>-T RealignerTargetCreator -nt 1</args_realign_target>
			  <args_realign_indel>-T IndelRealigner --consensusDeterminationModel KNOWNS_ONLY -LOD 0.4</args_realign_indel>
			  <args_base_recal>-T BaseRecalibrator</args_base_recal>
			  <args_print_reads>-T PrintReads</args_print_reads>
			  <args_haplo_call>-T HaplotypeCaller -nt 1 -ERC GVCF --minPruning 3 --maxNumHaplotypesInPopulation 200 --max_alternate_alleles 3 -contamination 0.0</args_haplo_call>
			  <args_genotype_gvcf>-T GenotypeGVCFs -nt 1</args_genotype_gvcf> 
			  <args_snv_var_recal>-T VariantRecalibrator -nt 1 --maxGaussians 4 -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR -an DP -mode SNP</args_snv_var_recal>
			  <args_snv_apply_recal>-T ApplyRecalibration  -nt 1 -mode SNP</args_snv_apply_recal>
			  <args_indel_var_recal>-T VariantRecalibrator -nt 1 --maxGaussians 4 -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR -an DP -mode INDEL</args_indel_var_recal>
			  <args_indel_apply_recal>-T ApplyRecalibration  -nt 1 -mode INDEL</args_indel_apply_recal>
			  <genome_indel_file>1000G_phase1.indels.b37.vcf</genome_indel_file>
			  <genome_snv_file>1000G_phase1.snps.high_confidence.b37.vcf</genome_snv_file>
			  <mills_indel_file>Mills_and_1000G_gold_standard.indels.b37.vcf</mills_indel_file>
			  <omni_file>1000G_omni2.5.b37.vcf</omni_file>
			  <hapmap_file>hapmap_3.3.b37.vcf</hapmap_file>
			  <dbsnp_file>dbsnp_138.b37.vcf</dbsnp_file>
			</gatk>
			
			<picard>
				  <jar>&binbase;/picard-tools-2.4.1/picard.jar</jar>
				  <version>2.4.1</version>
				  <args_markdup>MarkDuplicates AS=TRUE VALIDATION_STRINGENCY=LENIENT</args_markdup>
			</picard>

			<delly>
				<binary>&binbase;/delly</binary>
				<exclude>&binbase;/delly.excl</exclude>
				<version>0.7.3</version>
				<call>
					<args_del>call -t DEL</args_del>
					<args_dup>call -t DUP</args_dup>
					<args_inv>call -t INV</args_inv>
					<args_ins>call -t INS</args_ins>
					<args_tra>call -t TRA</args_tra>
				</call> 
			</delly>
			
			<lumpy>
				<binary>&binbase;/lumpyexpress</binary>
				<exclude>&binbase;/lumpy.excl</exclude>
				<version> 0.2.13</version>
			</lumpy>
			
		</binaries>
			
		<cutoffs>
			<snv_quality_cutoff>40</snv_quality_cutoff>
			<clr_cutoff>60</clr_cutoff>
			<indel_quality_cutoff>40</indel_quality_cutoff>
			<max_variant_cutoff>1000</max_variant_cutoff>
			<min_variant_cutoff>2</min_variant_cutoff>
			<min_cover_cutoff>4</min_cover_cutoff>
			<gatk_indel_vqsr>99.0</gatk_indel_vqsr>                                                                                                            
			<gatk_snv_vqsr>99.5</gatk_snv_vqsr>
			<splice_length_cutoff>10</splice_length_cutoff>
			<sv_max_distance>250</sv_max_distance>
		</cutoffs>
																			
	</human_related_gatk>

	
	<human_single_gatk>
		<organism>human</organism>
		<paired_variants>0</paired_variants>
		<parallel_vcf>1</parallel_vcf>
		<min_align_percent>85</min_align_percent> <!-- Minimum percent of reads in lane to count as passed -->
		
		<db_types>ALL</db_types> 
		
		<annotation_version>
			<ref_genome>hs37d5</ref_genome>
			<dbsnp_version>137_147</dbsnp_version>
			<exon_version>040614</exon_version>
			<gene_version>120116</gene_version>
			<ensembl_version>88</ensembl_version>
			<cosmic_version>75</cosmic_version>
			<chr>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 X Y</chr>
			<exac_version>0.3</exac_version>
            <clinvar_version>070515</clinvar_version>
            <aB_FOXP3_regulatory_version>240615</aB_FOXP3_regulatory_version>
        	<mirna_version>221116</mirna_version>
        	<dgv_version>230715</dgv_version>
    	</annotation_version>
	
		<binaries>
			<tabix>
				<binary>&binbase;/tabix</binary>
				<version>0.2.5 (r964)</version>
			</tabix>

			<bwa>
				<binary>&binbase;/bwa</binary>
				<version>0.6.1-r104</version>
				<aln>
					<args>aln </args>
				</aln>
				<sampe>
					<args>sampe </args>
				</sampe>
			</bwa>
	
			<samtools>
				<binary>&binbase;/samtools-1.3.1</binary>
				<version>1.3.1 (using htslib 1.3.1)</version>
				<mpileup>
					<args>mpileup -C50 -uDEf</args>
				</mpileup>
			</samtools>
	
			<bcftools>
				<binary>&binbase;/bcftools</binary>
				<version>1.3.1-16-g16414e6 (using htslib 1.3.1-36-g11661a5)</version>
				<view>
					<unpaired_args>view -vcg</unpaired_args>
				</view>
			</bcftools>
			
			<variant_predictor>
				<binary>&binbase;/variant_effect_predictor.pl</binary>
				<version>88</version>
				<args_exon>--force_overwrite --cache --offline --species human --fork 2 --canonical --coding_only --poly b --sift b --plugin CADD,&binbase;/whole_genome_SNVs.tsv.gz</args_exon>
				<args_all>--force_overwrite --cache --offline --species human --fork 2 --canonical --domains --af --pubmed --check_existing --numbers --plugin CADD,&binbase;/whole_genome_SNVs.tsv.gz --biotype --regulatory</args_all>
			</variant_predictor>
	
			<javabin>
			  # on raijin- must first do ...  module load java/jdk1.8.0_60
			  <binary>java </binary>
			  <version>jdk1.8.0_60</version>
			</javabin>

			<gatk>
			  <jar>&binbase;/GATK-3.6.0/GenomeAnalysisTK.jar</jar>
			  <version>3.6.0</version>
			  <args_realign_target>-T RealignerTargetCreator -nt 1</args_realign_target>
			  <args_realign_indel>-T IndelRealigner --consensusDeterminationModel KNOWNS_ONLY -LOD 0.4</args_realign_indel>
			  <args_base_recal>-T BaseRecalibrator</args_base_recal>
			  <args_print_reads>-T PrintReads</args_print_reads>
			  <args_haplo_call>-T HaplotypeCaller -nt 1 -ERC GVCF --minPruning 3 --maxNumHaplotypesInPopulation 200 --max_alternate_alleles 3 -contamination 0.0</args_haplo_call>
			  <args_genotype_gvcf>-T GenotypeGVCFs -nt 1</args_genotype_gvcf> 
			  <args_snv_var_recal>-T VariantRecalibrator -nt 1 --maxGaussians 4 -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR -an DP -mode SNP</args_snv_var_recal>
			  <args_snv_apply_recal>-T ApplyRecalibration  -nt 1 -mode SNP</args_snv_apply_recal>
			  <args_indel_var_recal>-T VariantRecalibrator -nt 1 --maxGaussians 4 -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR -an DP -mode INDEL</args_indel_var_recal>
			  <args_indel_apply_recal>-T ApplyRecalibration  -nt 1 -mode INDEL</args_indel_apply_recal>
			  <genome_indel_file>1000G_phase1.indels.b37.vcf</genome_indel_file>
			  <genome_snv_file>1000G_phase1.snps.high_confidence.b37.vcf</genome_snv_file>
			  <mills_indel_file>Mills_and_1000G_gold_standard.indels.b37.vcf</mills_indel_file>
			  <omni_file>1000G_omni2.5.b37.vcf</omni_file>
			  <hapmap_file>hapmap_3.3.b37.vcf</hapmap_file>
			  <dbsnp_file>dbsnp_138.b37.vcf</dbsnp_file>
			</gatk>
			
			<picard>
				  <jar>&binbase;/picard-tools-2.4.1/picard.jar</jar>
				  <version>2.4.1</version>
				  <args_markdup>MarkDuplicates AS=TRUE VALIDATION_STRINGENCY=LENIENT</args_markdup>
			</picard>
		
			<delly>
				<binary>&binbase;/delly</binary>
				<exclude>&binbase;/delly.excl</exclude>
				<version>0.7.3</version>
				<call>
					<args_del>call -t DEL</args_del>
					<args_dup>call -t DUP</args_dup>
					<args_inv>call -t INV</args_inv>
					<args_ins>call -t INS</args_ins>
					<args_tra>call -t TRA</args_tra>
				</call> 
			</delly>
			
			<lumpy>
				<binary>&binbase;/lumpyexpress</binary>
				<exclude>&binbase;/lumpy.excl</exclude>
				<version> 0.2.13</version>
			</lumpy>
			
		</binaries>
	
		<cutoffs>
			<snv_quality_cutoff>40</snv_quality_cutoff>
			<clr_cutoff>60</clr_cutoff>
			<indel_quality_cutoff>40</indel_quality_cutoff>
			<max_variant_cutoff>1000</max_variant_cutoff>
			<min_variant_cutoff>2</min_variant_cutoff>
			<min_cover_cutoff>4</min_cover_cutoff>
			<gatk_indel_vqsr>99.0</gatk_indel_vqsr>                                                                                                            
			<gatk_snv_vqsr>99.5</gatk_snv_vqsr>
			<splice_length_cutoff>10</splice_length_cutoff>
			<sv_max_distance>250</sv_max_distance>
		</cutoffs>
	</human_single_gatk>

</pipeline>
