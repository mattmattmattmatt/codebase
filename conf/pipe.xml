<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE page [
<!ENTITY binbase "/g/data/u86/variantdb/v2.38/ext/bin">
<!ENTITY pipeline_version "v2.38">
<!ENTITY basedir "/g/data/u86/variantdb">
<!ENTITY svndir "&basedir;/&pipeline_version;">
]>
<pipeline>
 	
	<common>
		<!-- possible source types -->
		<source_types>human_related,human_single,human_related_gatk,human_single_gatk</source_types>	
		<!-- possible sample types-->
	<sample_types>single_affected,single_unaffected,related_affected,related_unaffected</sample_types>
	
		<!-- possible related types -->
		<related_types>proband,mother,father,parent,brother,sister,sibling,grandfather,grandmother,son,daughter,child,other,aunt,uncle,niece,nephew,cousin,other,spouse</related_types>
		
		<database>
			<db_name>vardb_genome_2_38</db_name>
			<host>130.56.244.153</host>
			<user>igl_user</user> 
		</database>
			
		<run_subdirs>overlap,vcf,conf,log,polyphen,summary,bam,gatk,sv</run_subdirs>
		
		<sequencing_centres>BRF,AGRF,BGI,Macrogen,Garvan,Unknown,Novogene</sequencing_centres>
		
		<pipeline_version>v2.38</pipeline_version>
		
		<!-- Steps with special meaning in the pipeline-->
		<pipe_steps>			
			<first_lane>bwa</first_lane>
			<first>merge_bam</first> <!-- First step of whole pipeline -->
			<last>scp_results</last> <!-- Last step of whole pipeline -->
			<parvar_first>submit_snvs</parvar_first> <!-- Step to create parallel variant calling jobs -->
			<parvar_record>single_vcf</parvar_record> <!-- Step that runs after single chr variant calling job is done -->
			<start_non_parvar>call_all_variants</start_non_parvar>
			<parvar_merge>merge_vcf</parvar_merge> <!-- Step after all parallel variant calls done -->
			<finish_align>bam_stats</finish_align> <!-- Last step of alignment phase -->
		</pipe_steps>
		
		<!-- tells which snv types to store in DB -->
		<db_types>ALL</db_types> 
		
		<sv_callers>delly,lumpy</sv_callers>
		<sv_types>del,dup,inv,ins,tra</sv_types>
	</common>
	
	<human_related_gatk>
		<organism>human</organism>
		<paired_variants>0</paired_variants>
		<parallel_vcf>1</parallel_vcf>
		<min_align_percent>85</min_align_percent> <!-- Minimum percent of reads in lane to count as passed -->
		<db_types>ALL</db_types> 
				
		<annotation_version>
			<ref_genome>GRCh38</ref_genome>
			<dbsnp_version>141_142_144_146_147_150/</dbsnp_version>
			<exon_version>021118/</exon_version>
			<gene_version>021118/</gene_version>
			<ensembl_version>94</ensembl_version>
			<cosmic_version>v86/</cosmic_version>
			<chr>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 X Y</chr>
      <gnomad_version>2.0.1_vep38</gnomad_version>
      <clinvar_version>021118</clinvar_version>
      <mirna_version>22.1</mirna_version>
      <dgv_version>20160831</dgv_version>
    </annotation_version>
																													
		<binaries>
			<tabix>
				<binary>&binbase;/tabix</binary>
				<version>1.6</version>
			</tabix>

			<bgzip>
				<binary>&binbase;/bgzip</binary>
				<version>1.6</version>
			</bgzip>

			<bwa>
				<binary>&binbase;/bwa</binary>
				<version>0.7.17-r1188</version>
				<aln>
					<args>aln </args>
				</aln>
				<sampe>
					<args>sampe </args>
				</sampe>
			</bwa>
			
			<samtools>
				<binary>&binbase;/samtools</binary>
				<version>1.6 (using htslib 1.6)</version>
				<mpileup>
					<args>mpileup -C50 -uDEf</args>
				</mpileup>
			</samtools>
								
			<!-- marcin on 4/04/2019 -->
			<VariantBam>
				<binary>&binbase;/variant</binary>
				<version>1.4</version>
			</VariantBam>
																				
			<bcftools>
				<binary>&binbase;/bcftools</binary>
				<version>1.6 (using htslib 1.6)</version>
				<view>
					<unpaired_args>view -vcg</unpaired_args>
				</view>
			</bcftools>
			
			<variant_predictor>
				<binary>&binbase;/vep</binary>
				<version>94</version>
				<args_exon>--force_overwrite --cache --offline --species homo_sapiens --fork 2 --canonical --coding_only --poly b --sift b --plugin CADD,&svndir;/conf/human/GRCh38/vep_index/plugin_resources/whole_genome_SNVs.tsv.gz</args_exon>
				<args_all>--force_overwrite --cache --offline --species homo_sapiens --fork 2 --canonical --domains --af --pubmed --check_existing --numbers --plugin CADD,&svndir;/conf/human/GRCh38/vep_index/plugin_resources/whole_genome_SNVs.tsv.gz --biotype --regulatory</args_all>
			</variant_predictor>
																																																		
			<javabin>
				  <binary>java -Djava.io.tmpdir=$PBS_JOBFS </binary>
				  <!-- gadi version in use, on raijin it was jdk1.8.0_60 -->
				  <version>jdk-8.40</version>
			</javabin>

      <pythonbin>
      	<!--
        # marcin on 27/07/2017 to get lumpy working. Used in .steps.xml files, curently only for lumpy step
        # not actaully needed anymore on gadi as there are no python modules
        -->
        <binary>python</binary>
        <version>2.7.15</version>
      </pythonbin>

			<vcftools>
				<binary>&binbase;/vcftools</binary>
				<concat>&binbase;/vcf-concat</concat>
				<sort>&binbase;/vcf-sort</sort>
				<version>0.1.16</version>
			</vcftools>
			
			<gatk>
			  <jar>&binbase;/GenomeAnalysisTK.jar</jar>
			  <version>3.6.0</version>
			  <args_realign_target>-T RealignerTargetCreator -nt 1</args_realign_target>
			  <args_realign_indel>-T IndelRealigner --consensusDeterminationModel KNOWNS_ONLY -LOD 0.4</args_realign_indel>
			  <args_base_recal>-T BaseRecalibrator</args_base_recal>
			  <args_print_reads>-T PrintReads</args_print_reads>
			  <args_haplo_call>-T HaplotypeCaller -nt 1 -ERC GVCF --minPruning 3 --maxNumHaplotypesInPopulation 200 --max_alternate_alleles 3 -contamination 0.0</args_haplo_call>
			  <args_genotype_gvcf>-T GenotypeGVCFs -nt 1</args_genotype_gvcf> 
			  <args_snv_var_recal>-T VariantRecalibrator -nt 1 --maxGaussians 4 -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR -an DP -mode SNP</args_snv_var_recal>
			  <args_snv_var_recal_fallback>-T VariantRecalibrator -nt 1 --maxGaussians 1 -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR -an DP -mode SNP</args_snv_var_recal_fallback>
			  <args_indel_var_recal_fallback>-T VariantRecalibrator -nt 1 --maxGaussians 1 -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR -an DP -mode INDEL</args_indel_var_recal_fallback>
			  <args_snv_apply_recal>-T ApplyRecalibration  -nt 1 -mode SNP</args_snv_apply_recal>
			  <args_indel_var_recal>-T VariantRecalibrator -nt 1 --maxGaussians 4 -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR -an DP -mode INDEL</args_indel_var_recal>
			  <args_indel_apply_recal>-T ApplyRecalibration  -nt 1 -mode INDEL</args_indel_apply_recal>
			  <genome_indel_file>Homo_sapiens_assembly38.known_indels.vcf</genome_indel_file>
			  <genome_snv_file>1000G_phase1.snps.high_confidence.hg38.vcf</genome_snv_file>
			  <mills_indel_file>Mills_and_1000G_gold_standard.indels.hg38.vcf</mills_indel_file>
			  <omni_file>1000G_omni2.5.hg38.vcf</omni_file>
			  <hapmap_file>hapmap_3.3.hg38.vcf</hapmap_file>
			  <dbsnp_file>Homo_sapiens_assembly38.dbsnp138.vcf</dbsnp_file>
			</gatk>
			
			<picard>
				  <jar>&binbase;/picard.jar</jar>
				  <version>2.17.4</version>
				  <args_markdup>MarkDuplicates AS=TRUE VALIDATION_STRINGENCY=LENIENT</args_markdup>
			</picard>

			<delly>
				<binary>&binbase;/delly</binary>
				<exclude>&svndir;/conf/human/GRCh38/resources/human.hg38.excl.tsv</exclude>
				<version>0.7.8</version>
				<call>
					<args_del>call -t DEL</args_del>
					<args_dup>call -t DUP</args_dup>
					<args_inv>call -t INV</args_inv>
					<args_ins>call -t INS</args_ins>
					<args_tra>call -t TRA</args_tra>
				</call> 
			</delly>
			
			<lumpy>
				<binary>&binbase;/lumpyexpress</binary>
				<exclude>&svndir;/conf/human/GRCh38/resources/human.hg38.excl.tsv</exclude>
				<version> 0.2.13</version>
			</lumpy>
			
		</binaries>
			
		<cutoffs>
			<snv_quality_cutoff>40</snv_quality_cutoff>
			<clr_cutoff>60</clr_cutoff>
			<indel_quality_cutoff>40</indel_quality_cutoff>
			<max_variant_cutoff>1000</max_variant_cutoff>
			<min_variant_cutoff>2</min_variant_cutoff>
			<min_cover_cutoff>4</min_cover_cutoff>
			<gatk_indel_vqsr>99.0</gatk_indel_vqsr>                                                                                                            
			<gatk_snv_vqsr>99.5</gatk_snv_vqsr>
			<splice_length_cutoff>10</splice_length_cutoff>
			<sv_max_distance>250</sv_max_distance>
		</cutoffs>
																			
	</human_related_gatk>

	
	<human_single_gatk>
		<organism>human</organism>
		<paired_variants>0</paired_variants>
		<parallel_vcf>1</parallel_vcf>
		<min_align_percent>85</min_align_percent> <!-- Minimum percent of reads in lane to count as passed -->
		
		<db_types>ALL</db_types> 
		
		<annotation_version>
			<ref_genome>GRCh38</ref_genome>
			<dbsnp_version>141_142_144_146_147_150</dbsnp_version>
			<exon_version>021118</exon_version>
			<gene_version>021118</gene_version>
			<ensembl_version>94</ensembl_version>
			<cosmic_version>v86/</cosmic_version>
			<chr>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 X Y</chr>
			<gnomad_version>2.0.1_vep38</gnomad_version>
      <clinvar_version>021118</clinvar_version>
      <mirna_version>22.1</mirna_version>
      <dgv_version>20160831</dgv_version>
   </annotation_version>
	
		<binaries>
			<tabix>
				<binary>&binbase;/tabix</binary>
				<version>1.6</version>
			</tabix>

			<bgzip>
				<binary>&binbase;/bgzip</binary>
				<version>1.6</version>
			</bgzip>

			<bwa>
				<binary>&binbase;/bwa</binary>
				<version>0.7.17-r1188</version>
				<aln>
					<args>mem </args>
				</aln>
				<sampe>
					<args>sampe </args>
				</sampe>
			</bwa>
	
			<samtools>
				<binary>&binbase;/samtools</binary>
				<version>1.6 (using htslib 1.6)</version>
				<mpileup>
					<args>mpileup -C50 -uDEf</args>
				</mpileup>
			</samtools>
	
			<!-- marcin on 4/04/2019 -->
			<VariantBam>
				<binary>&binbase;/variant</binary>
				<version>1.4</version>
			</VariantBam>

			<bcftools>
				<binary>&binbase;/bcftools</binary>
				<version>1.6 (using htslib 1.6)</version>
				<view>
					<unpaired_args>view -vcg</unpaired_args>
				</view>
			</bcftools>
			
			<variant_predictor>
				<binary>&binbase;/vep</binary>
				<version>94</version>
				<args_exon>--force_overwrite --cache --offline --species homo_sapiens --fork 2 --canonical --coding_only --poly b --sift b --plugin CADD,&svndir;/conf/human/GRCh38/vep_index/plugin_resources/whole_genome_SNVs.tsv.gz</args_exon>
				<args_all>--force_overwrite --cache --offline --species homo_sapiens --fork 2 --canonical --domains --af --pubmed --check_existing --numbers --plugin CADD,&svndir;/conf/human/GRCh38/vep_index/plugin_resources/whole_genome_SNVs.tsv.gz --biotype --regulatory</args_all>
			</variant_predictor>
	
			<javabin>
			  <binary>java -Djava.io.tmpdir=$PBS_JOBFS </binary>
			  <version>jdk-8.40</version>
			</javabin>

      <pythonbin>
        <binary>python</binary>
        <version>2.7.15</version>
      </pythonbin>

			<vcftools>
				<binary>&binbase;/vcftools</binary>
				<concat>&binbase;/vcf-concat</concat>
				<sort>&binbase;/vcf-sort</sort>
				<version>0.1.16</version>
			</vcftools>

			<gatk>
			  <jar>&binbase;/GenomeAnalysisTK.jar</jar>
			  <version>3.6.0</version>
			  <args_realign_target>-T RealignerTargetCreator -nt 1</args_realign_target>
			  <args_realign_indel>-T IndelRealigner --consensusDeterminationModel KNOWNS_ONLY -LOD 0.4</args_realign_indel>
			  <args_base_recal>-T BaseRecalibrator</args_base_recal>
			  <args_print_reads>-T PrintReads</args_print_reads>
			  <args_haplo_call>-T HaplotypeCaller -nt 1 -ERC GVCF --minPruning 3 --maxNumHaplotypesInPopulation 200 --max_alternate_alleles 3 -contamination 0.0</args_haplo_call>
			  <args_genotype_gvcf>-T GenotypeGVCFs -nt 1</args_genotype_gvcf> 
			  <args_snv_var_recal>-T VariantRecalibrator -nt 1 --maxGaussians 4 -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR -an DP -mode SNP</args_snv_var_recal>
			  <args_snv_var_recal_fallback>-T VariantRecalibrator -nt 1 --maxGaussians 1 -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR -an DP -mode SNP</args_snv_var_recal_fallback>
 			  <args_indel_var_recal_fallback>-T VariantRecalibrator -nt 1 --maxGaussians 1 -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR -an DP -mode INDEL</args_indel_var_recal_fallback>
			  <args_snv_apply_recal>-T ApplyRecalibration  -nt 1 -mode SNP</args_snv_apply_recal>
			  <args_indel_var_recal>-T VariantRecalibrator -nt 1 --maxGaussians 4 -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR -an DP -mode INDEL</args_indel_var_recal>
			  <args_indel_apply_recal>-T ApplyRecalibration  -nt 1 -mode INDEL</args_indel_apply_recal>
			  <genome_indel_file>Homo_sapiens_assembly38.known_indels.vcf</genome_indel_file>
			  <genome_snv_file>1000G_phase1.snps.high_confidence.hg38.vcf</genome_snv_file>
			  <mills_indel_file>Mills_and_1000G_gold_standard.indels.hg38.vcf</mills_indel_file>
			  <omni_file>1000G_omni2.5.hg38.vcf</omni_file>
			  <hapmap_file>hapmap_3.3.hg38.vcf</hapmap_file>
			  <dbsnp_file>Homo_sapiens_assembly38.dbsnp138.vcf</dbsnp_file>
			</gatk>
			
			<picard>
				  <jar>&binbase;/picard.jar</jar>
				  <version>2.17.4</version>
				  <args_markdup>MarkDuplicates AS=TRUE VALIDATION_STRINGENCY=LENIENT</args_markdup>
			</picard>
		
			<delly>
				<binary>&binbase;/delly</binary>
				<exclude>&svndir;/conf/human/GRCh38/resources/human.hg38.excl.tsv</exclude>
				<version>0.7.8</version>
				<call>
					<args_del>call -t DEL</args_del>
					<args_dup>call -t DUP</args_dup>
					<args_inv>call -t INV</args_inv>
					<args_ins>call -t INS</args_ins>
					<args_tra>call -t TRA</args_tra>
				</call> 
			</delly>
			
			<lumpy>
				<binary>&binbase;/lumpyexpress</binary>
				<exclude>&svndir;/conf/human/GRCh38/resources/human.hg38.excl.tsv</exclude>
				<version> 0.2.13</version>
			</lumpy>
			
		</binaries>
	
		<cutoffs>
			<snv_quality_cutoff>40</snv_quality_cutoff>
			<clr_cutoff>60</clr_cutoff>
			<indel_quality_cutoff>40</indel_quality_cutoff>
			<max_variant_cutoff>1000</max_variant_cutoff>
			<min_variant_cutoff>2</min_variant_cutoff>
			<min_cover_cutoff>4</min_cover_cutoff>
			<gatk_indel_vqsr>99.0</gatk_indel_vqsr>                                                                                                            
			<gatk_snv_vqsr>99.5</gatk_snv_vqsr>
			<splice_length_cutoff>10</splice_length_cutoff>
			<sv_max_distance>250</sv_max_distance>
		</cutoffs>
	</human_single_gatk>

</pipeline>
